<!DOCTYPE html>
<html lang="en">

<head>
    <script src="script.js"></script>
    <link rel="stylesheet" href="style.css" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fake Store Api Test</title>
</head>

<body>
    <div class="d-flex justify-content-center">
        <div class="spinner-border" role="status" id="loading">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
    <h1>Fake Store Products</h1>

    <table width="75%" align="center" id="products" cellpadding="15"></table>
</body>
<script>
    // all products
    const all_url =
        "https://fakestoreapi.com/products/";


    async function getAllProducts(url) {

        // Storing response
        const response = await fetch(url);

        // Storing data in form of JSON
        const data = await response.json();
        console.log(data);
        if (response) {
            hideloader();
        }
        showAllProducts(data);
    }

    async function getProduct(id) {

        // Storing response
        const response = await fetch(`${all_url}${id}`);

        // Storing data in form of JSON
        const data = await response.json();
        console.log(data);
        if (response) {
            hideloader();
        }
        showProduct(data);
    }

    getAllProducts(all_url);



    // Function to hide the loader
    function hideloader() {
        document.getElementById('loading').style.display = 'none';
    }


    function showProduct(data) {
        let tab =
            `<tr>
          <th>Product</th>
          <th>Description</th>
          <th>Rating</th>
          <th>Price</th>
        </tr>`;



        tab += `<tr> 
    <td>
        <h3>${data.title}</h3>
        <i>Category: </i> ${data.category}
        <p><img style='max-width:200px;height:auto;' src='${data.image}'></p>
    </td> 
    <td>${data.description}</td>
    <td>${data.rating.rate} (${data.rating.count} ratings)</td>    
    <td>${data.price}</td>              
    </tr>`;

        // Setting innerHTML as tab variable
        document.getElementById("products").innerHTML = tab;
    }

    //
    function showAllProducts(data) {
        let tab =
            `<tr>
          <th>Image</th>
          <th>Product</th>
          <th>Rating</th>
          <th>Price</th>
        </tr>`;


        for (let r of data) {
            tab += `<tr> 
            <td><img style='max-width:100px;height:auto;' src='${r.image}'></td>
            <td><h3><a href='#' onclick='getProduct(${r.id})'>${r.title}</a></h3></td>
            <td>${r.rating.rate} (${r.rating.count} ratings)</td>    
            <td>$${r.price}</td>              
            </tr>`;
        }

        // Setting innerHTML as tab variable
        document.getElementById("products").innerHTML = tab;
    }
</script>

</html>